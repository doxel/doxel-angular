
<div class="view" id="segments">

  <div class="tree">
    <ul class="year" ng-show="viewMode=='tree'">
      <li ng-repeat="(year, month) in tree">
        <a ng-click="toggle($event,year)">
          <i ng-class="expanded[year] ? 'fa fa-caret-down' : 'fa fa-caret-right'"></i>
          <i ng-class="expanded[year] ? 'fa fa-folder-open' : 'fa fa-folder'"></i>
          <span>{{year}}</span>
        </a>
        <ul class="month" ng-show="expanded[year]">
          <li ng-repeat="(month, day) in tree[year]" ng-init="ym=year+month; ym2=year+'.'+month">
            <a ng-click="toggle($event,ym2)">
              <i ng-class="expanded[ym] ? 'fa fa-caret-down' : 'fa fa-caret-right'"></i>
              <i ng-class="expanded[ym] ? 'fa fa-folder-open' : 'fa fa-folder'"></i>
              <span>{{month}}</span>
            </a>
            <ul class="day" ng-show="expanded[ym]">
              <li ng-repeat="(day, timestamp) in tree[year][month]" ng-init="ymd=ym+day; ymd2=ym2+'.'+day">
                <a ng-click="toggle($event,ymd2)">
                  <i ng-class="expanded[ymd] ? 'fa fa-caret-down' : 'fa fa-caret-right'"></i>
                  <i ng-class="expanded[ymd] ? 'fa fa-folder-open' : 'fa fa-folder'"></i>
                  <span>{{day}}<span>
                </a>
                <ul class="timestamp" ng-show="expanded[ymd]">
                  <li ng-repeat="(timestamp, segmentId) in tree[year][month][day]" ng-init="ymdt=ymd+timestamp; ymdt2=ymd2+'.'+timestamp">
                    <a ng-click="toggle($event,ymdt2)">
                      <i ng-class="expanded[ymdt] ? 'fa fa-caret-down' : 'fa fa-caret-right'"></i>
                      <i ng-class="expanded[ymdt] ? 'fa fa-folder-open' : 'fa fa-folder'"></i>
                      <span>{{timestamp | formatTimestamp : 'hms'}}</span>
                    </a>
                    <ul class="segmentId" ng-show="expanded[ymdt]">
                      <li ng-repeat="(segmentId, segment) in tree[year][month][day][timestamp]" ng-init="ymdts=ymdt+segmentId; ymdts2=ymdt2+'.'+segmentId">
                        <a ng-click="toggle($event,ymdts2)">
                          <i ng-class="expanded[ymdts] ? 'fa fa-caret-down' : 'fa fa-caret-right'"></i>
                          <i ng-class="expanded[ymdts] ? 'fa fa-folder-open' : 'fa fa-folder'"></i>
                        <span>{{segmentId}}</span>
                        </a>
                        <ul class="picture" ng-show="expanded[ymdts]">
                          <li ng-repeat="(index, picture) in tree[year][month][day][timestamp][segmentId]" ng-init="ymdtsp=ymdts+picture.id; ymdtsp2=ymdts2+'.'+picture.id">
                            <a ng-click="toggle($event,ymdtsp2,index)">
                              <!--i ng-class="expanded[year+month+day+timestamp+segmentId+picture.id] ? 'fa fa-caret-down' : 'fa fa-caret-right'"></i-->
                              <i class="fa""></i>
                              <i class="fa fa-file-image-o"></i>
                              <span>{{picture.timestamp | formatTimestamp : 'hms'}}</span>
                            </a>
                            <ul class="picture_detail">
                              <li></li>
                            </ul>
                          </li>
                        </ul>
                      </li>
                    </ul>
                  </li>
                </ul>
              </li>
            </ul>
          </li>
        </ul>
      </li>
    </ul>
  </div>

  <div ng-show="viewMode=='list'">
    <table ng-show="viewMode=='list'" ng-table="tableParams" show-filter="true" class="table table-condensed table-bordered table-striped">
      <tr ng-repeat="row in data">
        <td data-title="'Preview'" preview="row.previewId"></td>
        <td data-title="'Date'" filter="{ '_timestamp': 'text' }" sortable="'timestamp'">{{row._timestamp}}</td>
      </tr>
    </table>
  </div>

  <div ng-show="viewMode=='tree'" class="details">
    <div ng-show="view=='year'" class="year">
    </div>
    <div ng-show="view=='month'" class="month">
    </div>
    <div ng-show="view=='day'" class="day">
    </div>
    <div ng-show="view=='timestamp'" class="timestamp">
    </div>
    <div ng-show="view=='segment'" class="segment">
    </div>
    <div ng-show="view=='picture'" class="picture">
      <img ng-src="{{blob}}" imgonload="imgloaded($event)">
    </div>
  </div>

</div>
